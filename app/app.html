<table>
<tr><td><button onclick="appButton(103);" style="font-size:larger;">Up</button></td><td align="right"><button onclick="appButton(108);" style="font-size:larger;">Down</button></td></tr>
<tr><td colspan="2"><canvas id="canvas" width=128 height=128 style="width:512px; height:512px; margin:15px 0px;"></canvas></td></tr>
<tr><td><button onclick="appButton(105);" style="font-size:larger;">Left</button></td><td align="right"><button onclick="appButton(106);" style="font-size:larger;">Right</button></td></tr>
</table>
<br>
<br>
<button onclick="appRequestPasscode(123456);" style="font-size:larger;">Request Passcode</button>
<br>
<br>
<button onclick="appServerReceive('test', 1);" style="font-size:larger;">Notification serverReceive</button>
<script>
var Module;

function appInit(log) {
	Module = {
		print: function(text) { if (log) console.log(text); },
		canvas: (function() { return document.getElementById("canvas"); })(),
//		argument: ["-s"]
	};

	const script = document.createElement("script");
	script.type = "text/javascript";
	script.src = "app.js";
	document.body.appendChild(script);
}

function appButton(b) {
	Module._button(b);
}

function appRequestPasscode(p) {
	Module._requestPasscode(p);
}

function appCommunicationStatus(s) {
	Module._communicationStatus(s);
}

function appServerWriteData(data, isB64) {
	var st;
	if (isB64)
		st = atob(data);
	else
		st = data;
	console.log("(JS) serverWriteData: #" + st + "#B64:" + isB64);
}

function appServerReceive(data, doB64) {
	var st;
	if (doB64)
		st = btoa(data);
	else
		st = data;
	var size = lengthBytesUTF8(st) + 1;
	var ptr = Module._malloc(size);
	stringToUTF8(st, ptr, size);
	Module._serverReceive(ptr, doB64);
	Module._free(ptr);
}
	</script>
<script>
appInit(1);
</script>
