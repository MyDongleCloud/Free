<div class="flex min-h-screen text--gray-900">
	<app-sidebar></app-sidebar>
	<div class="flex-1 flex flex-col min-h-screen">
		<app-topbar title="{{L('Settings')}}"></app-topbar>
		<div class="flex gap-3 mt-4 mr-4">
			<div class="ml-4">{{L("Your external IP address:")}} {{externalIP}}<br>{{L("System internal / external IP addresses:")}} {{global.session?.hardware?.internalIP}} / {{global.session?.hardware?.externalIP}}</div>
			<div class="flex-1"></div>
			<button (click)="save()" [disabled]="dSave" class="inline-flex items-center gap-2 px-4 py-2 bg--blue-600 border border--gray-300 rounded-lg text-sm font-medium text--white hover:bg--blue-700 transition-colors cursor-pointer disabled:bg--gray-100 disabled:cursor-default disabled:text--gray-400">
				<ion-icon name="save-outline" class="w-4 h-4"></ion-icon>
				{{L("Save")}}
			</button>
		</div>
		<div>
			<main class="flex-1 p-6 bg-background space-y-6">
				<div class="border-b border--gray-200">
					<nav class="flex space-x-8">
						<button (click)="activeTab = 'general'" [class]="activeTab == 'general' ? 'border--blue-500 text--blue-600' : 'border-transparent text--gray-500 hover:text--gray-700 hover:border--gray-300'" class="py-2 px-1 border-b-2 font-medium text-sm transition-colors">
							{{L("General")}}
						</button>
						<button (click)="activeTab = 'domains'" [class]="activeTab == 'domains' ? 'border--blue-500 text--blue-600' : 'border-transparent text--gray-500 hover:text--gray-700 hover:border--gray-300'" class="py-2 px-1 border-b-2 font-medium text-sm transition-colors">
							{{L("Domains")}}
						</button>
						<button (click)="activeTab = 'connectivity'" [class]="activeTab == 'connectivity' ? 'border--blue-500 text--blue-600' : 'border-transparent text--gray-500 hover:text--gray-700 hover:border--gray-300'" class="py-2 px-1 border-b-2 font-medium text-sm transition-colors">
							{{L("Connectivity")}}
						</button>
						<button (click)="activeTab = 'security'" [class]="activeTab == 'security' ? 'border--blue-500 text--blue-600' : 'border-transparent text--gray-500 hover:text--gray-700 hover:border--gray-300'" class="py-2 px-1 border-b-2 font-medium text-sm transition-colors">
							{{L("Security")}}
						</button>
					</nav>
				</div>
				<div class="space-y-6">
				@if (activeTab == 'general') {
					<div class="rounded-xl border border--gray-200 p-6 shadow-sm">
						<h3 class="text-lg font-semibold text--gray-900 mb-6">{{L("General Settings")}}</h3>
						<div class="space-y-6">
							<div>
								<h4 class="text-md font-medium text--gray-900 mb-4">{{L("Dongle Settings")}}</h4>
								<div class="space-y-4">
									<div class="flex items-center justify-between">
										<div>
											<p class="text-sm font-medium text--gray-700 mb-3">{{L("Language")}}</p>
											<div class="flex rounded-lg border border--gray-200 p-1">
												<label class="relative flex flex-col cursor-pointer items-center justify-center rounded-md px-3 py-1.5 transition-all duration-300">
													<input type="radio" name="language" value="en" class="peer sr-only" checked (click)="global.changeLanguage('en');"/>
													<span class="absolute inset-0 z-0 rounded-md bg--gray-100 opacity-0 transition-all duration-300 peer-checked:opacity-100"></span>
													<span class="relative z-10 font-medium transition-all duration-300 peer-checked:text--gray-900">ðŸ‡ºðŸ‡¸<br>EN</span>
												</label>
												<label class="relative flex flex-col grow cursor-pointer items-center justify-center rounded-md px-3 py-1.5 transition-all duration-300">
													<input type="radio" name="language" value="fr" class="peer sr-only"  (click)="global.changeLanguage('fr');"/>
													<span class="absolute inset-0 z-0 rounded-md bg--gray-100 opacity-0 transition-all duration-300 peer-checked:opacity-100"></span>
													<span class="relative z-10 font-medium transition-all duration-300 peer-checked:text--gray-900">ðŸ‡«ðŸ‡·<br>FR</span>
												</label>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				}
				@if (activeTab == 'domains') {
					<div class="rounded-xl border border--gray-200 p-6 shadow-sm">
						<h3 class="text-lg font-semibold text--gray-900 mb-6">{{L("Domains")}}</h3>
						<div class="space-y-6">
							<div>
								<label class="block text-sm font-medium text--gray-700 mb-2">{{L("Cloud Name")}}</label>
								<input type="text" disabled="true" value="https://{{global.session.cloud.all?.name}}.mydongle.cloud" class="px-3 py-2 border border--gray-300 rounded-lg text--gray-500">
							</div>
							<div>
								<label class="block text-sm font-medium text--gray-700 mb-2">{{L("Short Name")}}</label>
								<input type="text" disabled="true" value="https://{{global.session.cloud.all?.shortname}}.myd.cd" class="px-3 py-2 border border--gray-300 rounded-lg text--gray-500">
							</div>
							<div>
								<label class="block text-sm font-medium text--gray-700 mb-2">{{L("BYO Domains (Bring Your Own Domains)")}}</label>
								<input type="text" disabled="true" value="{{global.session.cloud.all?.domains?.join(', ')}}" class="px-3 py-2 border border--gray-300 rounded-lg text--gray-500">
							</div>
							<button (click)="refresh()" class="inline-flex items-center gap-2 px-4 py-2 bg--yellow-600 text--white rounded-lg text-sm font-medium hover:bg--yellow-700 transition-colors cursor-pointer">
								<ion-icon name="refresh-outline" class="text--white w-4 h-4"></ion-icon>
								<span class="text-lg">{{L("Refresh Backend")}}</span>
							</button>
						</div>
					</div>
				}
				@if (activeTab == 'connectivity') {
					<div class="rounded-xl border border--gray-200 p-6 shadow-sm">
						<h3 class="text-lg font-semibold text--gray-900 mb-6">{{L("Wi-Fi")}}</h3>
						<div class="space-y-6">
							<div>
								<label class="block text-sm font-medium text--gray-700 mb-2">{{L("SSID")}}</label>
								<input type="text" disabled="true" value="https://{{global.session.cloud.all?.name}}.mydongle.cloud" class="px-3 py-2 border border--gray-300 rounded-lg text--gray-500">
							</div>
							<div>
								<label class="block text-sm font-medium text--gray-700 mb-2">{{L("Password")}}</label>
								<input type="text" disabled="true" value="https://{{global.session.cloud.all?.shortname}}.myd.cd" class="px-3 py-2 border border--gray-300 rounded-lg text--gray-500">
							</div>
							<button (click)="wifiApply()" class="inline-flex items-center gap-2 px-4 py-2 bg--yellow-600 text--white rounded-lg text-sm font-medium hover:bg--yellow-700 transition-colors cursor-pointer">
								<span class="text-lg">{{L("Apply")}}</span>
							</button>
						</div>
					</div>
				}
				@if (activeTab == 'security') {
					<div class="rounded-xl border border--gray-200 p-6 shadow-sm">
						<h3 class="text-lg font-semibold text--gray-900 mb-6">{{L("Security Settings")}}</h3>
						<div class="space-y-6">
							<div>
								<h4 class="text-md font-medium text--gray-900 mb-4">{{L("Main")}}</h4>
								<div class="space-y-4">
									<div class="flex items-center justify-between">
										<div>
											<p class="text-sm font-medium text--gray-700">{{L("Sudo")}}</p>
											<p class="text-sm text--gray-500">{{L("Admin account has sudo rights")}}</p>
										</div>
										<input type="checkbox" [(ngModel)]="adminSudo" (change)="dSave = false;" class="w-4 h-4 text--blue-600 focus:ring--blue-500 border--gray-300 rounded">
									</div>
								</div>
							</div>
							<div class="border-t border--gray-200 pt-6">
								<h4 class="text-md font-medium text--gray-900 mb-4">{{L("SSH")}}</h4>
								<div class="space-y-4">
									<div class="flex items-center justify-between">
										<p class="text-sm text--gray-500">{{L("SSH settings can be tuned in the SSH module.")}}</p>
									</div>
								</div>
							</div>
							<div class="border-t border--gray-200 pt-6">
								<h4 class="text-md font-medium text--gray-900 mb-4">{{L("Notification")}}</h4>
								<div class="space-y-4">
									<div class="flex items-center justify-between">
										<div>
											<p class="text-sm font-medium text--gray-700">{{L("Sign-In")}}</p>
											<p class="text-sm text--gray-500">{{L("Email notification to user upon successful sign-in")}}</p>
										</div>
										<input type="checkbox" [(ngModel)]="signInNotification" (change)="dSave = false;" class="w-4 h-4 text--blue-600 focus:ring--blue-500 border--gray-300 rounded">
									</div>
								</div>
							</div>
						</div>
					</div>
				}
				</div>
			</main>
		</div>
	</div>
</div>
